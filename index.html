<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#fdf2f8">
    <title>Aplikasi Hitung Gerakan Buah Hati</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Nunito:wght@700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fdf2f8; 
            -webkit-tap-highlight-color: transparent;
        }

        .heading-font {
            font-family: 'Nunito', sans-serif;
        }

        .kick-button {
            transition: transform 0.1s active;
            box-shadow: 0 10px 25px -5px rgba(219, 39, 119, 0.3);
        }

        .kick-button:active {
            transform: scale(0.95);
        }

        .progress-ring {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        ::-webkit-scrollbar {
            width: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #fbcfe8;
            border-radius: 10px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <header class="w-full max-w-md text-center mb-6 mt-4">
        <h1 class="heading-font text-2xl text-pink-600">Aplikasi Hitung Gerakan Buah Hati</h1>
        <p class="text-gray-500 text-sm">Pantau aktivitas janin Anda setiap hari</p>
    </header>

    <main class="w-full max-w-md bg-white rounded-3xl p-6 shadow-xl relative overflow-hidden mb-6">
        <div class="flex justify-between items-center mb-6">
            <div>
                <span id="session-status" class="bg-pink-100 text-pink-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider">
                    Sesi Belum Dimulai
                </span>
            </div>
            <div class="text-right">
                <p class="text-gray-400 text-xs uppercase">Durasi</p>
                <p id="timer-display" class="font-mono font-bold text-gray-700">00:00:00</p>
            </div>
        </div>

        <div class="relative flex justify-center items-center mb-8">
            <svg width="200" height="200">
                <circle class="text-gray-100" stroke-width="12" stroke="currentColor" fill="transparent" r="85" cx="100" cy="100"/>
                <circle id="progress-bar" class="text-pink-500 progress-ring" stroke-width="12" stroke-dasharray="534" stroke-dashoffset="0" stroke-linecap="round" stroke="currentColor" fill="transparent" r="85" cx="100" cy="100"/>
            </svg>
            <div class="absolute inset-0 flex flex-col justify-center items-center">
                <span id="kick-count" class="heading-font text-6xl text-pink-600">0</span>
                <span class="text-gray-400 font-semibold uppercase text-xs tracking-widest">Gerakan</span>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4">
            <button id="btn-kick" class="kick-button w-full bg-pink-500 hover:bg-pink-600 text-white py-6 rounded-2xl text-xl font-bold flex flex-col items-center justify-center space-y-1 shadow-lg disabled:opacity-50" disabled>
                <span>HITUNG GERAKAN</span>
                <span class="text-xs font-normal opacity-80 text-white italic">Klik setiap kali bayi bergerak</span>
            </button>
            
            <div class="flex space-x-3">
                <button id="btn-start" class="flex-1 bg-green-500 text-white py-3 rounded-xl font-bold hover:bg-green-600 transition shadow-md">
                    MULAI SESI
                </button>
                <button id="btn-stop" class="flex-1 bg-gray-200 text-gray-600 py-3 rounded-xl font-bold hover:bg-gray-300 transition hidden">
                    SELESAI
                </button>
                <button id="btn-reset" class="flex-1 bg-red-100 text-red-600 py-3 rounded-xl font-bold hover:bg-red-200 transition">
                    RESET
                </button>
            </div>
        </div>
    </main>

    <section class="w-full max-w-md">
        <div class="flex justify-between items-center mb-3 px-2">
            <h2 class="heading-font text-lg text-gray-700">Riwayat Terakhir</h2>
            <button id="btn-clear-history" class="text-xs text-gray-400 hover:text-red-500">Hapus Semua</button>
        </div>
        <div id="history-list" class="space-y-3">
            <div class="text-center py-8 text-gray-400 italic text-sm">Belum ada riwayat tercatat.</div>
        </div>
    </section>

    <div class="w-full max-w-md mt-8 p-4 bg-blue-50 border border-blue-100 rounded-2xl text-blue-800 text-xs">
        <p class="font-bold mb-1">ðŸ’¡ Tips Aplikasi Hitung Gerakan Buah Hati:</p>
        <p>Gunakan aplikasi ini untuk memantau pola gerakan bayi secara rutin. Jika Anda merasa gerakan berkurang secara drastis dari biasanya dalam periode 2 jam, jangan ragu untuk berkonsultasi dengan dokter kandungan.</p>
    </div>

    <div class="w-full max-w-md mt-4 p-4 bg-white border border-gray-100 rounded-2xl text-gray-600 text-[10px] text-center">
        <p class="font-bold mb-1">CARA PASANG DI HOME SCREEN (ANDROID):</p>
        <p>Klik titik tiga (â‹®) di pojok kanan atas Chrome, lalu pilih <strong>"Tambahkan ke Layar Utama"</strong> atau <strong>"Add to Home Screen"</strong>.</p>
    </div>

    <script>
        const kickDisplay = document.getElementById('kick-count');
        const timerDisplay = document.getElementById('timer-display');
        const statusDisplay = document.getElementById('session-status');
        const progressBar = document.getElementById('progress-bar');
        const historyList = document.getElementById('history-list');
        
        const btnKick = document.getElementById('btn-kick');
        const btnStart = document.getElementById('btn-start');
        const btnStop = document.getElementById('btn-stop');
        const btnReset = document.getElementById('btn-reset');
        const btnClear = document.getElementById('btn-clear-history');

        let count = 0;
        let startTime = null;
        let timerInterval = null;
        let isRunning = false;
        const CIRCUMFERENCE = 2 * Math.PI * 85;

        progressBar.style.strokeDasharray = CIRCUMFERENCE;
        progressBar.style.strokeDashoffset = 0;

        function updateTimer() {
            const now = new Date();
            const diff = new Date(now - startTime);
            const h = String(diff.getUTCHours()).padStart(2, '0');
            const m = String(diff.getUTCMinutes()).padStart(2, '0');
            const s = String(diff.getUTCSeconds()).padStart(2, '0');
            timerDisplay.textContent = `${h}:${m}:${s}`;
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('kick_history') || '[]');
            if (history.length === 0) {
                historyList.innerHTML = '<div class="text-center py-8 text-gray-400 italic text-sm">Belum ada riwayat tercatat.</div>';
                return;
            }

            historyList.innerHTML = history.reverse().map(item => `
                <div class="bg-white p-4 rounded-2xl shadow-sm flex justify-between items-center border-l-4 border-pink-400">
                    <div>
                        <p class="font-bold text-gray-700">${item.count} Gerakan</p>
                        <p class="text-[10px] text-gray-400 uppercase font-semibold">${item.date} â€¢ ${item.time}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-gray-500 font-mono">${item.duration}</p>
                        <p class="text-[10px] text-pink-500 font-bold">TERCATAT</p>
                    </div>
                </div>
            `).join('');
        }

        function saveSession() {
            if (count === 0) return;
            
            const now = new Date();
            const session = {
                count: count,
                duration: timerDisplay.textContent,
                date: now.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' }),
                time: now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }),
                timestamp: now.getTime()
            };

            const history = JSON.parse(localStorage.getItem('kick_history') || '[]');
            history.push(session);
            localStorage.setItem('kick_history', JSON.stringify(history));
            loadHistory();
        }

        btnStart.addEventListener('click', () => {
            isRunning = true;
            count = 0;
            kickDisplay.textContent = '0';
            startTime = new Date();
            timerInterval = setInterval(updateTimer, 1000);
            
            btnStart.classList.add('hidden');
            btnStop.classList.remove('hidden');
            btnKick.disabled = false;
            statusDisplay.textContent = 'Sesi Berjalan';
            statusDisplay.className = 'bg-green-100 text-green-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider';
        });

        btnKick.addEventListener('click', () => {
            if (!isRunning) return;
            count++;
            kickDisplay.textContent = count;
            
            if (window.navigator.vibrate) {
                window.navigator.vibrate(50);
            }
        });

        btnStop.addEventListener('click', () => {
            clearInterval(timerInterval);
            isRunning = false;
            saveSession();
            
            btnStop.classList.add('hidden');
            btnStart.classList.remove('hidden');
            btnKick.disabled = true;
            statusDisplay.textContent = 'Sesi Selesai';
            statusDisplay.className = 'bg-gray-100 text-gray-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider';
        });

        btnReset.addEventListener('click', () => {
            if (confirm('Reset hitungan dan waktu sekarang?')) {
                clearInterval(timerInterval);
                isRunning = false;
                count = 0;
                kickDisplay.textContent = '0';
                timerDisplay.textContent = '00:00:00';
                btnStop.classList.add('hidden');
                btnStart.classList.remove('hidden');
                btnKick.disabled = true;
                statusDisplay.textContent = 'Sesi Belum Dimulai';
                statusDisplay.className = 'bg-pink-100 text-pink-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider';
            }
        });

        btnClear.addEventListener('click', () => {
            if (confirm('Hapus semua riwayat permanen?')) {
                localStorage.removeItem('kick_history');
                loadHistory();
            }
        });

        loadHistory();
    </script>
</body>
</html>